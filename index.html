<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Snake Draft — Full Board + Scroll + Roster</title>
<style>
  :root {
    --bg:#fff; --panel:#fff; --panel-2:#f8fafc; --text:#0f172a; --muted:#64748b; --accent:#2563eb; --line:#e5e7eb;
    --qb:#3b82f6; --rb:#22c55e; --wr:#ef4444; --te:#f97316; --k:#eab308; --dst:#a855f7;
  }
  *{box-sizing:border-box} html,body{height:100%} body{margin:0;background:var(--bg);color:var(--text);font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial}
  header{padding:16px 20px;display:flex;justify-content:space-between;align-items:center;border-bottom:1px solid var(--line);position:sticky;top:0;background:rgba(255,255,255,.95);backdrop-filter:blur(6px);z-index:50}
  .title{font-size:20px;font-weight:700} .controls{display:flex;gap:8px;flex-wrap:wrap}
  .btn{border:1px solid var(--line);background:#f8fafc;padding:8px 10px;border-radius:10px;cursor:pointer;font-weight:600}
  .btn:hover{border-color:var(--accent)} .btn.danger{border-color:#ef4444;color:#b91c1c} .btn.small{font-size:12px}
  .layout{display:flex;flex-direction:column;gap:16px;padding:16px;width:100%}
  .panel{background:var(--panel);border:1px solid var(--line);border-radius:14px;overflow:hidden;display:flex;flex-direction:column;width:100%}
  .panel-header{padding:12px 14px;border-bottom:1px solid var(--line);background:var(--panel-2);display:flex;align-items:center;justify-content:space-between;gap:8px;flex-wrap:wrap}
  .panel-title{font-weight:700} .panel-content{padding:12px}
  .legend{display:flex;gap:8px;flex-wrap:wrap;align-items:center;font-size:12px} .legend .dot{width:10px;height:10px;border-radius:999px;display:inline-block}
  .error{padding:12px 16px;color:#b91c1c;background:#fee2e2;border:1px solid #fecaca;border-radius:12px;margin:0 0 8px 0;display:none}

  /* Full board with vertical scroll for ~6 rounds */
  .board-wrap{overflow-x:auto; overflow-y:auto; max-height: 360px; border: 1px solid var(--line); border-radius: 12px;}
  .board{min-width: 1100px; width: 100%; display:grid; grid-template-columns: 90px repeat(12, minmax(0, 1fr));}
  .hdr,.cell{border-bottom:1px solid var(--line);border-right:1px solid var(--line);padding:8px}
  .hdr{background:var(--panel-2);font-weight:700;text-align:center;position:sticky;top:0;z-index:5}
  .sticky-col{position:sticky;left:0;z-index:6;background:var(--panel-2);text-align:center;font-weight:700}
  .team-input{width:100%;background:transparent;border:none;color:var(--text);text-align:center;font-weight:700;outline:none}
  .round-label{font-weight:700;color:var(--muted)}
  .cell{min-height:52px;display:flex;align-items:center;justify-content:space-between;gap:10px;background:#fff;font-size:14px;position:relative}
  .cell:hover{background:#f8fafc} .cell.selected{outline:2px solid var(--accent);z-index:1}
  .player-pill{display:inline-flex;align-items:center;gap:8px;padding:6px 8px;border-radius:10px;background:#fff;border:1px solid var(--line);max-width:100%;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}
  .pos-dot{width:12px;height:12px;border-radius:999px;flex:0 0 auto} .pill-text{overflow:hidden;text-overflow:ellipsis}
  .pill-actions{display:flex;gap:6px;flex:0 0 auto} .icon-btn{border:1px solid var(--line);background:transparent;color:#64748b;border-radius:8px;padding:2px 6px;font-size:12px;cursor:pointer}
  .icon-btn:hover{color:var(--text);border-color:var(--accent)}

  /* Below: My Team (left) | Rankings (right) */
  .below{display:grid;grid-template-columns:400px 1fr;gap:16px}
  @media (max-width: 900px) { .below{grid-template-columns:1fr} }
  .input,.select,.checkbox-label{background:#fff;color:var(--text);border:1px solid var(--line);border-radius:10px;padding:8px 10px;outline:none}
  .rankings-wrap{max-height:70vh;overflow:auto;border:1px solid var(--line);border-radius:12px}
  .rank-table{width:100%;border-collapse:collapse;font-size:14px}
  .rank-table th,.rank-table td{border-bottom:1px solid var(--line);padding:8px 10px;text-align:left;white-space:nowrap}
  .rank-table thead th{position:sticky;top:0;background:var(--panel-2);z-index:3} .rank-row{cursor:pointer;background:#fff} .rank-row:hover{background:#f8fafc}
  .drafted{background:#f1f5f9!important;color:#94a3b8;text-decoration:line-through}
  .pos-chip{display:inline-flex;align-items:center;gap:6px;border:1px solid var(--line);padding:4px 6px;border-radius:999px;font-size:12px;background:#fff}

  /* Roster */
  .roster{display:grid;grid-template-columns:1fr;gap:8px}
  .slot{display:flex;align-items:center;justify-content:space-between;gap:8px;border:1px solid var(--line);border-radius:10px;padding:8px 10px;background:#fff}
  .slot-label{font-weight:700;color:#334155} .empty{color:#94a3b8}
  .bench-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:8px}
  .needs{margin-top:8px;font-size:12px;color:#475569}
</style>
</head>
<body>
<header>
  <div class="title">Snake Draft Board · 12 Team · 15 Rounds · Half PPR</div>
  <div class="controls">
    <button class="btn small" id="saveStateBtn">Save</button>
    <button class="btn small" id="loadStateBtn">Load</button>
    <button class="btn small danger" id="clearStateBtn">Clear</button>
    <button class="btn small" id="downloadJsonBtn">Export JSON</button>
  </div>
</header>

<div class="layout">
  <div id="errorBox" class="error"></div>

  <!-- Draft Board -->
  <div class="panel">
    <div class="panel-header">
      <div class="panel-title">Draft Board</div>
      <div class="legend">
        <span class="chip"><span class="dot" style="background: var(--qb)"></span>QB</span>
        <span class="chip"><span class="dot" style="background: var(--rb)"></span>RB</span>
        <span class="chip"><span class="dot" style="background: var(--wr)"></span>WR</span>
        <span class="chip"><span class="dot" style="background: var(--te)"></span>TE</span>
        <span class="chip"><span class="dot" style="background: var(--k)"></span>K</span>
        <span class="chip"><span class="dot" style="background: var(--dst)"></span>DEF/ST</span>
      </div>
    </div>
    <div class="panel-content">
      <div id="boardWrap" class="board-wrap">
        <div id="board" class="board"></div>
      </div>
    </div>
  </div>

  <!-- Below: Roster + Rankings -->
  <div class="below">
    <div class="panel">
      <div class="panel-header">
        <div class="panel-title" id="myTeamTitle">My Team</div>
      </div>
      <div class="panel-content">
        <div class="roster" id="roster"></div>
        <div class="needs" id="needsText"></div>
      </div>
    </div>

    <div class="panel">
      <div class="panel-header">
        <div class="panel-title">My Rankings</div>
        <div class="tools">
          <input class="input" id="searchInput" placeholder="Search player..." />
          <select class="select" id="posFilter">
            <option value="">All Positions</option>
            <option value="QB">QB</option>
            <option value="RB">RB</option>
            <option value="WR">WR</option>
            <option value="TE">TE</option>
            <option value="K">K</option>
            <option value="DST">DEF/ST</option>
          </select>
          <label class="checkbox-label"><input type="checkbox" id="hideDrafted" /> Hide drafted</label>
        </div>
      </div>
      <div class="panel-content">
        <div class="rankings-wrap">
          <table class="rank-table" id="rankingsTable">
            <thead>
              <tr><th>Overall</th><th>Player</th><th>Pos</th><th>Pos Rank</th><th>Tier</th></tr>
            </thead>
            <tbody id="rankingsBody"></tbody>
          </table>
        </div>
      </div>
    </div>
  </div>
</div>

<footer style="padding:12px 16px;opacity:.8;font-size:12px;text-align:center">
  Tip: Click a board cell to select it, then click a player in the rankings to place them. Use the ✕ to clear a pick.
</footer>

<script>
(function() {
  const showError = (msg) => { const el = document.getElementById('errorBox'); el.textContent = msg; el.style.display = 'block'; };

  try {
    const RANKINGS_DATA = [{"overall": 1, "player": "Ja'Marr Chase", "pos": "WR", "posRank": 1, "tier": 1}, {"overall": 2, "player": "Bijan Robinson", "pos": "RB", "posRank": 1, "tier": 1}, {"overall": 3, "player": "Jahmyr Gibbs", "pos": "RB", "posRank": 2, "tier": 1}, {"overall": 4, "player": "Saquon Barkley", "pos": "RB", "posRank": 3, "tier": 1}, {"overall": 5, "player": "CeeDee Lamb", "pos": "WR", "posRank": 2, "tier": 1}, {"overall": 6, "player": "Justin Jefferson", "pos": "WR", "posRank": 3, "tier": 1}, {"overall": 7, "player": "Christian McCaffrey", "pos": "RB", "posRank": 4, "tier": 1}, {"overall": 8, "player": "Nico Collins", "pos": "WR", "posRank": 4, "tier": 2}, {"overall": 9, "player": "Puka Nacua", "pos": "WR", "posRank": 5, "tier": 2}, {"overall": 10, "player": "Malik Nabers", "pos": "WR", "posRank": 6, "tier": 2}, {"overall": 11, "player": "Drake London", "pos": "WR", "posRank": 7, "tier": 2}, {"overall": 12, "player": "De'Von Achane", "pos": "RB", "posRank": 5, "tier": 2}, {"overall": 13, "player": "Brian Thomas", "pos": "WR", "posRank": 8, "tier": 2}, {"overall": 14, "player": "Amon-Ra St. Brown", "pos": "WR", "posRank": 9, "tier": 2}, {"overall": 15, "player": "Derrick Henry", "pos": "RB", "posRank": 6, "tier": 2}, {"overall": 16, "player": "Ashton Jeanty", "pos": "RB", "posRank": 7, "tier": 3}, {"overall": 17, "player": "AJ Brown", "pos": "WR", "posRank": 10, "tier": 3}, {"overall": 18, "player": "Brock Bowers", "pos": "TE", "posRank": 1, "tier": 3}, {"overall": 19, "player": "Chase Brown", "pos": "RB", "posRank": 8, "tier": 3}, {"overall": 20, "player": "Bucky Irving", "pos": "RB", "posRank": 9, "tier": 4}, {"overall": 21, "player": "Ladd McConkey", "pos": "WR", "posRank": 11, "tier": 4}, {"overall": 22, "player": "Jonathan Taylor", "pos": "RB", "posRank": 10, "tier": 4}, {"overall": 23, "player": "Josh Jacobs", "pos": "RB", "posRank": 11, "tier": 4}, {"overall": 24, "player": "Trey McBride", "pos": "TE", "posRank": 2, "tier": 5}, {"overall": 25, "player": "Josh Allen", "pos": "QB", "posRank": 1, "tier": 5}, {"overall": 26, "player": "Jaxon Smith-Njigba", "pos": "WR", "posRank": 12, "tier": 6}, {"overall": 27, "player": "Omarion Hampton", "pos": "RB", "posRank": 12, "tier": 6}, {"overall": 28, "player": "Tee Higgins", "pos": "WR", "posRank": 13, "tier": 6}, {"overall": 29, "player": "Lamar Jackson", "pos": "QB", "posRank": 2, "tier": 6}, {"overall": 30, "player": "Tyreek Hill", "pos": "WR", "posRank": 14, "tier": 7}, {"overall": 31, "player": "Davante Adams", "pos": "WR", "posRank": 15, "tier": 7}, {"overall": 32, "player": "Kyren Williams", "pos": "RB", "posRank": 13, "tier": 7}, {"overall": 33, "player": "Kenneth Walker", "pos": "RB", "posRank": 14, "tier": 7}, {"overall": 34, "player": "TreVeyon Henderson", "pos": "RB", "posRank": 15, "tier": 7}, {"overall": 35, "player": "Jayden Daniels", "pos": "QB", "posRank": 3, "tier": 7}, {"overall": 36, "player": "Jalen Hurts", "pos": "QB", "posRank": 4, "tier": 7}, {"overall": 37, "player": "Alvin Kamara", "pos": "RB", "posRank": 16, "tier": 7}, {"overall": 38, "player": "George Kittle", "pos": "TE", "posRank": 3, "tier": 7}, {"overall": 39, "player": "Mike Evans", "pos": "WR", "posRank": 16, "tier": 7}, {"overall": 40, "player": "James Cook", "pos": "RB", "posRank": 17, "tier": 7}, {"overall": 41, "player": "Breece Hall", "pos": "RB", "posRank": 18, "tier": 7}, {"overall": 42, "player": "Garrett Wilson", "pos": "WR", "posRank": 17, "tier": 8}, {"overall": 43, "player": "Marvin Harrison", "pos": "WR", "posRank": 18, "tier": 8}, {"overall": 44, "player": "Devonta Smith", "pos": "WR", "posRank": 19, "tier": 8}, {"overall": 45, "player": "Tetairoa McMillan", "pos": "WR", "posRank": 20, "tier": 8}, {"overall": 46, "player": "Jameson Williams", "pos": "WR", "posRank": 21, "tier": 8}, {"overall": 47, "player": "George Pickens", "pos": "WR", "posRank": 22, "tier": 8}, {"overall": 48, "player": "Calvin Ridley", "pos": "WR", "posRank": 23, "tier": 8}, {"overall": 49, "player": "Emeka Egbuka", "pos": "WR", "posRank": 24, "tier": 8}, {"overall": 50, "player": "James Conner", "pos": "RB", "posRank": 19, "tier": 9}, {"overall": 51, "player": "DK Metcalf", "pos": "WR", "posRank": 25, "tier": 9}, {"overall": 52, "player": "Xavier Worthy", "pos": "WR", "posRank": 26, "tier": 9}, {"overall": 53, "player": "Terry McLaurin", "pos": "WR", "posRank": 27, "tier": 9}, {"overall": 54, "player": "Chuba Hubbard", "pos": "RB", "posRank": 20, "tier": 9}, {"overall": 55, "player": "RJ Harvey", "pos": "RB", "posRank": 21, "tier": 9}, {"overall": 56, "player": "Travis Hunter", "pos": "WR", "posRank": 28, "tier": 9}, {"overall": 57, "player": "Jaylen Waddle", "pos": "WR", "posRank": 29, "tier": 9}, {"overall": 58, "player": "Courtland Sutton", "pos": "WR", "posRank": 30, "tier": 9}, {"overall": 59, "player": "DJ Moore", "pos": "WR", "posRank": 31, "tier": 9}, {"overall": 60, "player": "Tony Pollard", "pos": "RB", "posRank": 22, "tier": 10}, {"overall": 61, "player": "Rashee Rice", "pos": "WR", "posRank": 32, "tier": 10}, {"overall": 62, "player": "Joe Burrow", "pos": "QB", "posRank": 5, "tier": 10}, {"overall": 63, "player": "Stefon Diggs", "pos": "WR", "posRank": 33, "tier": 10}, {"overall": 64, "player": "Isiah Pacheco", "pos": "RB", "posRank": 23, "tier": 10}, {"overall": 65, "player": "Zay Flowers", "pos": "WR", "posRank": 34, "tier": 10}, {"overall": 66, "player": "Ricky Pearsall", "pos": "WR", "posRank": 35, "tier": 10}, {"overall": 67, "player": "Rome Odunze", "pos": "WR", "posRank": 36, "tier": 10}, {"overall": 68, "player": "Jakobi Meyers", "pos": "WR", "posRank": 37, "tier": 10}, {"overall": 69, "player": "D'Andre Swift", "pos": "RB", "posRank": 24, "tier": 11}, {"overall": 70, "player": "David Montgomery", "pos": "RB", "posRank": 25, "tier": 11}, {"overall": 71, "player": "Chris Olave", "pos": "WR", "posRank": 38, "tier": 11}, {"overall": 72, "player": "Aaron Jones", "pos": "RB", "posRank": 26, "tier": 11}, {"overall": 73, "player": "Jerry Jeudy", "pos": "WR", "posRank": 39, "tier": 11}, {"overall": 74, "player": "Jauan Jennings", "pos": "WR", "posRank": 40, "tier": 11}, {"overall": 75, "player": "Matthew Golden", "pos": "WR", "posRank": 41, "tier": 11}, {"overall": 76, "player": "Jordan Addison", "pos": "WR", "posRank": 42, "tier": 12}, {"overall": 77, "player": "Sam LaPorta", "pos": "TE", "posRank": 4, "tier": 12}, {"overall": 78, "player": "Deebo Samuel", "pos": "WR", "posRank": 43, "tier": 12}, {"overall": 79, "player": "Jaylen Warren", "pos": "RB", "posRank": 27, "tier": 13}, {"overall": 80, "player": "Tyrone Tracy", "pos": "RB", "posRank": 28, "tier": 13}, {"overall": 81, "player": "Kaleb Johnson", "pos": "RB", "posRank": 29, "tier": 13}, {"overall": 82, "player": "Khalil Shakir", "pos": "WR", "posRank": 44, "tier": 13}, {"overall": 83, "player": "TJ Hockenson", "pos": "TE", "posRank": 5, "tier": 13}, {"overall": 84, "player": "JK Dobbins", "pos": "RB", "posRank": 30, "tier": 14}, {"overall": 85, "player": "Jayden Reed", "pos": "WR", "posRank": 45, "tier": 14}, {"overall": 86, "player": "Keon Coleman", "pos": "WR", "posRank": 46, "tier": 14}, {"overall": 87, "player": "Patrick Mahomes", "pos": "QB", "posRank": 6, "tier": 15}, {"overall": 88, "player": "Justin Fields", "pos": "QB", "posRank": 7, "tier": 15}, {"overall": 89, "player": "Kyler Murray", "pos": "QB", "posRank": 8, "tier": 15}, {"overall": 90, "player": "Cooper Kupp", "pos": "WR", "posRank": 47, "tier": 15}, {"overall": 91, "player": "Josh Downs", "pos": "WR", "posRank": 48, "tier": 15}, {"overall": 92, "player": "Mark Andrews", "pos": "TE", "posRank": 6, "tier": 15}, {"overall": 93, "player": "Drake Maye", "pos": "QB", "posRank": 9, "tier": 15}, {"overall": 94, "player": "Bo Nix", "pos": "QB", "posRank": 10, "tier": 15}, {"overall": 95, "player": "Caleb Williams", "pos": "QB", "posRank": 11, "tier": 15}, {"overall": 96, "player": "Jordan Mason", "pos": "RB", "posRank": 31, "tier": 16}, {"overall": 97, "player": "Brock Purdy", "pos": "QB", "posRank": 12, "tier": 16}, {"overall": 98, "player": "Dak Prescott", "pos": "QB", "posRank": 13, "tier": 16}, {"overall": 99, "player": "Baker Mayfield", "pos": "QB", "posRank": 14, "tier": 16}, {"overall": 100, "player": "Rashid Shaheed", "pos": "WR", "posRank": 49, "tier": 16}, {"overall": 101, "player": "Chris Godwin", "pos": "WR", "posRank": 50, "tier": 16}, {"overall": 102, "player": "Michael Pittman", "pos": "WR", "posRank": 51, "tier": 16}, {"overall": 103, "player": "Christian Kirk", "pos": "WR", "posRank": 52, "tier": 16}, {"overall": 104, "player": "Justin Herbert", "pos": "QB", "posRank": 15, "tier": 16}, {"overall": 105, "player": "Evan Engram", "pos": "TE", "posRank": 7, "tier": 16}, {"overall": 106, "player": "Darnell Mooney", "pos": "WR", "posRank": 53, "tier": 16}, {"overall": 107, "player": "Travis Kelce", "pos": "TE", "posRank": 8, "tier": 16}, {"overall": 108, "player": "Travis Etienne", "pos": "RB", "posRank": 32, "tier": 16}, {"overall": 109, "player": "Zach Charbonnet", "pos": "RB", "posRank": 33, "tier": 17}, {"overall": 110, "player": "Cam Skattebo", "pos": "RB", "posRank": 34, "tier": 17}, {"overall": 111, "player": "Luther Burden", "pos": "WR", "posRank": 54, "tier": 17}, {"overall": 112, "player": "Tucker Kraft", "pos": "TE", "posRank": 9, "tier": 17}, {"overall": 113, "player": "Jayden Higgins", "pos": "WR", "posRank": 55, "tier": 17}, {"overall": 114, "player": "David Njoku", "pos": "TE", "posRank": 10, "tier": 17}, {"overall": 115, "player": "Tyler Warren", "pos": "TE", "posRank": 11, "tier": 17}, {"overall": 116, "player": "Trevor Lawrence", "pos": "QB", "posRank": 16, "tier": 18}, {"overall": 117, "player": "Jacory Croskey-Merritt", "pos": "RB", "posRank": 35, "tier": 18}, {"overall": 118, "player": "Keenan Allen", "pos": "WR", "posRank": 56, "tier": 18}, {"overall": 119, "player": "Tank Bigsby", "pos": "RB", "posRank": 36, "tier": 18}, {"overall": 120, "player": "Brandon Aiyuk", "pos": "WR", "posRank": 57, "tier": 18}, {"overall": 121, "player": "Bhayshul Tuten", "pos": "RB", "posRank": 37, "tier": 18}, {"overall": 122, "player": "Jaydon Blue", "pos": "RB", "posRank": 38, "tier": 18}, {"overall": 123, "player": "Jordan Love", "pos": "QB", "posRank": 17, "tier": 18}, {"overall": 124, "player": "Colston Loveland", "pos": "TE", "posRank": 12, "tier": 18}, {"overall": 125, "player": "Austin Ekeler", "pos": "RB", "posRank": 39, "tier": 19}, {"overall": 126, "player": "Javonte Williams", "pos": "RB", "posRank": 40, "tier": 19}, {"overall": 127, "player": "Rhamondre Stevenson", "pos": "RB", "posRank": 41, "tier": 19}, {"overall": 128, "player": "Marvin Mims", "pos": "WR", "posRank": 58, "tier": 19}, {"overall": 129, "player": "Dallas Goedert", "pos": "TE", "posRank": 13, "tier": 19}, {"overall": 130, "player": "Braelon Allen", "pos": "RB", "posRank": 42, "tier": 19}, {"overall": 131, "player": "Ray Davis", "pos": "RB", "posRank": 43, "tier": 20}, {"overall": 132, "player": "Tyjae Spears", "pos": "RB", "posRank": 44, "tier": 20}, {"overall": 133, "player": "Woody Marks", "pos": "RB", "posRank": 45, "tier": 20}, {"overall": 134, "player": "Nick Chubb", "pos": "RB", "posRank": 46, "tier": 20}, {"overall": 135, "player": "JJ McCarthy", "pos": "QB", "posRank": 18, "tier": 20}, {"overall": 136, "player": "Dalton Kincaid", "pos": "TE", "posRank": 14, "tier": 20}, {"overall": 137, "player": "Demario Douglas", "pos": "WR", "posRank": 59, "tier": 20}, {"overall": 138, "player": "Trey Benson", "pos": "RB", "posRank": 47, "tier": 20}, {"overall": 139, "player": "Jared Goff", "pos": "QB", "posRank": 19, "tier": 20}, {"overall": 140, "player": "Jake Ferguson", "pos": "TE", "posRank": 15, "tier": 20}, {"overall": 141, "player": "Cedric Tillman", "pos": "WR", "posRank": 60, "tier": 20}, {"overall": 142, "player": "Kyle Pitts", "pos": "TE", "posRank": 16, "tier": 20}, {"overall": 143, "player": "CJ Stroud", "pos": "QB", "posRank": 20, "tier": 20}, {"overall": 144, "player": "Josh Palmer", "pos": "WR", "posRank": 61, "tier": 21}, {"overall": 145, "player": "Rico Dowdle", "pos": "RB", "posRank": 48, "tier": 21}, {"overall": 146, "player": "Tre Harris", "pos": "WR", "posRank": 62, "tier": 21}, {"overall": 147, "player": "Hollywood Brown", "pos": "WR", "posRank": 63, "tier": 21}, {"overall": 148, "player": "Dylan Sampson", "pos": "RB", "posRank": 49, "tier": 21}, {"overall": 149, "player": "Pat Bryant", "pos": "WR", "posRank": 64, "tier": 21}, {"overall": 150, "player": "Rashod Bateman", "pos": "WR", "posRank": 65, "tier": 21}, {"overall": 151, "player": "Romeo Doubs", "pos": "WR", "posRank": 66, "tier": 21}, {"overall": 152, "player": "Isaac Guerendo", "pos": "RB", "posRank": 50, "tier": 21}, {"overall": 153, "player": "Chig Okonkwo", "pos": "TE", "posRank": 17, "tier": 22}, {"overall": 154, "player": "Jerome Ford", "pos": "RB", "posRank": 51, "tier": 22}, {"overall": 155, "player": "Adam Thielen", "pos": "WR", "posRank": 67, "tier": 22}, {"overall": 156, "player": "Kyle Williams", "pos": "WR", "posRank": 68, "tier": 22}, {"overall": 157, "player": "Rachaad White", "pos": "RB", "posRank": 52, "tier": 22}, {"overall": 158, "player": "Bryce Young", "pos": "QB", "posRank": 21, "tier": 22}, {"overall": 159, "player": "Brian Robinson", "pos": "RB", "posRank": 53, "tier": 22}, {"overall": 160, "player": "Brenton Strange", "pos": "TE", "posRank": 18, "tier": 22}, {"overall": 161, "player": "Michael Penix", "pos": "QB", "posRank": 22, "tier": 22}, {"overall": 162, "player": "Hunter Henry", "pos": "TE", "posRank": 19, "tier": 22}, {"overall": 163, "player": "Zach Ertz", "pos": "TE", "posRank": 20, "tier": 22}, {"overall": 164, "player": "Wan'Dale Robinson", "pos": "WR", "posRank": 69, "tier": 23}, {"overall": 165, "player": "Quinshon Judkins", "pos": "RB", "posRank": 54, "tier": 23}, {"overall": 166, "player": "Joe Mixon", "pos": "RB", "posRank": 55, "tier": 23}, {"overall": 167, "player": "Tyler Allgeier", "pos": "RB", "posRank": 56, "tier": 23}, {"overall": 168, "player": "Mason Taylor", "pos": "TE", "posRank": 21, "tier": 23}, {"overall": 169, "player": "Tua Tagovailoa", "pos": "QB", "posRank": 23, "tier": 23}, {"overall": 170, "player": "Cam Ward", "pos": "QB", "posRank": 24, "tier": 23}, {"overall": 171, "player": "Geno Smith", "pos": "QB", "posRank": 25, "tier": 23}, {"overall": 172, "player": "Xavier Legette", "pos": "WR", "posRank": 70, "tier": 23}, {"overall": 173, "player": "Jalen Coker", "pos": "WR", "posRank": 71, "tier": 23}, {"overall": 174, "player": "Sean Tucker", "pos": "RB", "posRank": 57, "tier": 23}, {"overall": 175, "player": "Kyle Monangai", "pos": "RB", "posRank": 58, "tier": 23}, {"overall": 176, "player": "Adonai Mitchell", "pos": "WR", "posRank": 72, "tier": 23}, {"overall": 177, "player": "Najee Harris", "pos": "RB", "posRank": 59, "tier": 24}, {"overall": 178, "player": "Tory Horton", "pos": "WR", "posRank": 73, "tier": 24}, {"overall": 179, "player": "Chris Rodriguez", "pos": "RB", "posRank": 60, "tier": 24}, {"overall": 180, "player": "Ollie Gordon", "pos": "RB", "posRank": 61, "tier": 24}, {"overall": 181, "player": "Justice Hill", "pos": "RB", "posRank": 62, "tier": 24}, {"overall": 182, "player": "Jaylen Wright", "pos": "RB", "posRank": 63, "tier": 24}, {"overall": 183, "player": "Dont'e Thornton", "pos": "WR", "posRank": 74, "tier": 24}, {"overall": 184, "player": "Roschon Johnson", "pos": "RB", "posRank": 64, "tier": 24}, {"overall": 185, "player": "Aaron Rodgers", "pos": "QB", "posRank": 26, "tier": 25}, {"overall": 186, "player": "Elijah Arroyo", "pos": "TE", "posRank": 22, "tier": 25}, {"overall": 187, "player": "Jack Bech", "pos": "WR", "posRank": 75, "tier": 25}, {"overall": 188, "player": "Jalen Royals", "pos": "WR", "posRank": 76, "tier": 25}, {"overall": 189, "player": "Troy Franklin", "pos": "WR", "posRank": 77, "tier": 25}, {"overall": 190, "player": "Jonnu Smith", "pos": "TE", "posRank": 23, "tier": 25}, {"overall": 191, "player": "Tahj Brooks", "pos": "RB", "posRank": 65, "tier": 25}, {"overall": 192, "player": "Matthew Stafford", "pos": "QB", "posRank": 27, "tier": 26}, {"overall": 193, "player": "DeAndre Hopkins", "pos": "WR", "posRank": 78, "tier": 26}, {"overall": 194, "player": "Isaiah Likely", "pos": "TE", "posRank": 24, "tier": 26}, {"overall": 195, "player": "Isaac TeSlaa", "pos": "WR", "posRank": 79, "tier": 26}, {"overall": 196, "player": "Pat Freiermuth", "pos": "TE", "posRank": 25, "tier": 26}, {"overall": 197, "player": "Theo Johnson", "pos": "TE", "posRank": 26, "tier": 26}, {"overall": 198, "player": "Brashard Smith", "pos": "RB", "posRank": 66, "tier": 26}, {"overall": 199, "player": "Jarquez Hunter", "pos": "RB", "posRank": 67, "tier": 26}, {"overall": 200, "player": "Dyami Brown", "pos": "WR", "posRank": 80, "tier": 26}, {"overall": 201, "player": "Jaylin Noel", "pos": "WR", "posRank": 81, "tier": 26}, {"overall": 202, "player": "DJ Giddens", "pos": "RB", "posRank": 68, "tier": 27}, {"overall": 203, "player": "Alec Pierce", "pos": "WR", "posRank": 82, "tier": 27}, {"overall": 204, "player": "Olamide Zaccheaus", "pos": "WR", "posRank": 83, "tier": 27}, {"overall": 205, "player": "Mike Gesicki", "pos": "TE", "posRank": 27, "tier": 27}, {"overall": 206, "player": "Ja'Tavion Sanders", "pos": "TE", "posRank": 28, "tier": 27}, {"overall": 207, "player": "Will Shipley", "pos": "RB", "posRank": 69, "tier": 27}, {"overall": 208, "player": "KeAndre Lambert-Smith", "pos": "WR", "posRank": 84, "tier": 27}, {"overall": 209, "player": "Keaton Mitchell", "pos": "RB", "posRank": 70, "tier": 27}, {"overall": 210, "player": "Roman Wilson", "pos": "WR", "posRank": 85, "tier": 27}, {"overall": 211, "player": "Kareem Hunt", "pos": "RB", "posRank": 71, "tier": 28}, {"overall": 212, "player": "Juwan Johnson", "pos": "TE", "posRank": 29, "tier": 28}, {"overall": 213, "player": "Elic Ayomanor", "pos": "WR", "posRank": 86, "tier": 28}, {"overall": 214, "player": "Cade Otton", "pos": "TE", "posRank": 30, "tier": 28}, {"overall": 215, "player": "Darius Slayton", "pos": "WR", "posRank": 87, "tier": 28}, {"overall": 216, "player": "Malik Washington", "pos": "WR", "posRank": 88, "tier": 28}, {"overall": 217, "player": "Oronde Gadsden", "pos": "TE", "posRank": 31, "tier": 29}, {"overall": 218, "player": "Diontae Johnson", "pos": "WR", "posRank": 89, "tier": 29}, {"overall": 219, "player": "Blake Corum", "pos": "RB", "posRank": 72, "tier": 29}, {"overall": 220, "player": "Dontayvion Wicks", "pos": "WR", "posRank": 90, "tier": 29}, {"overall": 221, "player": "Jaleel McLaughlin", "pos": "RB", "posRank": 73, "tier": 29}, {"overall": 222, "player": "Tyler Lockett", "pos": "WR", "posRank": 91, "tier": 29}, {"overall": 223, "player": "Calvin Austin", "pos": "WR", "posRank": 92, "tier": 29}, {"overall": 224, "player": "Andrei Iosivas", "pos": "WR", "posRank": 93, "tier": 29}, {"overall": 225, "player": "Miles Sanders", "pos": "RB", "posRank": 74, "tier": 30}, {"overall": 226, "player": "Elijah Mitchell", "pos": "RB", "posRank": 75, "tier": 30}, {"overall": 227, "player": "Tyler Higbee", "pos": "TE", "posRank": 32, "tier": 30}, {"overall": 228, "player": "Amari Cooper", "pos": "WR", "posRank": 94, "tier": 30}, {"overall": 229, "player": "Dalton Schultz", "pos": "TE", "posRank": 33, "tier": 30}, {"overall": 230, "player": "Sam Darnold", "pos": "QB", "posRank": 28, "tier": 30}, {"overall": 231, "player": "Jordan Whittington", "pos": "WR", "posRank": 95, "tier": 30}, {"overall": 232, "player": "Kendre Miller", "pos": "RB", "posRank": 76, "tier": 30}, {"overall": 233, "player": "Harold Fannin", "pos": "TE", "posRank": 34, "tier": 30}, {"overall": 234, "player": "Russell Wilson", "pos": "QB", "posRank": 29, "tier": 31}, {"overall": 235, "player": "Emanuel Wilson", "pos": "RB", "posRank": 77, "tier": 31}, {"overall": 236, "player": "Joe Flacco", "pos": "QB", "posRank": 30, "tier": 31}, {"overall": 237, "player": "Michael Wilson", "pos": "WR", "posRank": 96, "tier": 31}, {"overall": 238, "player": "Darren Waller", "pos": "TE", "posRank": 35, "tier": 31}, {"overall": 239, "player": "Raheem Mostert", "pos": "RB", "posRank": 78, "tier": 31}, {"overall": 240, "player": "Jaxson Dart", "pos": "QB", "posRank": 31, "tier": 32}, {"overall": 241, "player": "Trevor Etienne", "pos": "RB", "posRank": 79, "tier": 32}, {"overall": 242, "player": "Noah Gray", "pos": "TE", "posRank": 36, "tier": 32}, {"overall": 243, "player": "Quentin Johnston", "pos": "WR", "posRank": 97, "tier": 32}, {"overall": 244, "player": "Elijah Moore", "pos": "WR", "posRank": 98, "tier": 32}, {"overall": 245, "player": "Tutu Atwell", "pos": "WR", "posRank": 99, "tier": 32}, {"overall": 246, "player": "Isaiah Davis", "pos": "RB", "posRank": 80, "tier": 32}, {"overall": 247, "player": "Devaughn Vele", "pos": "WR", "posRank": 100, "tier": 32}, {"overall": 248, "player": "Jalen Nailor", "pos": "WR", "posRank": 101, "tier": 32}, {"overall": 249, "player": "Jalen Tolbert", "pos": "WR", "posRank": 102, "tier": 33}, {"overall": 250, "player": "Tre Tucker", "pos": "WR", "posRank": 103, "tier": 33}];
    const TEAMS = 12, ROUNDS = 15;
    const MY_TEAM_INDEX = 4; // 5th pick
    const MY_TEAM_NAME = "Team Fair";

    const POS_COLOR = {
      "QB":"var(--qb)","RB":"var(--rb)","WR":"var(--wr)","TE":"var(--te)",
      "K":"var(--k)","KICKER":"var(--k)","DEF":"var(--dst)","D/ST":"var(--dst)","DST":"var(--dst)","DEF/ST":"var(--dst)"
    };
    const POS_HEX = {
      "QB":"#3b82f6","RB":"#22c55e","WR":"#ef4444","TE":"#f97316","K":"#eab308","KICKER":"#eab308",
      "DEF":"#a855f7","D/ST":"#a855f7","DST":"#a855f7","DEF/ST":"#a855f7"
    };
    const posColor = p => POS_COLOR[String(p||"").toUpperCase().trim()] || "#94a3b8";
    const posHex   = p => POS_HEX[String(p||"").toUpperCase().trim()]   || "#94a3b8";
    const pickKey  = s => String(s||"").toUpperCase();
    const isSnakeLTR = r => r % 2 === 0;
    const pickNumber = (r,t) => r*TEAMS + (isSnakeLTR(r) ? t+1 : (TEAMS - t));
    const flexEligible = p => ["RB","WR","TE"].includes(String(p||"").toUpperCase());
    const hexToRgba = (hex,a)=>{const h=hex.replace('#','');const r=parseInt(h.slice(0,2),16),g=parseInt(h.slice(2,4),16),b=parseInt(h.slice(4,6),16);return `rgba(${r}, ${g}, ${b}, ${a})`;};

    let state = {
      teamNames: Array.from({length:TEAMS}, (_,i)=>"Team "+(i+1)),
      picks: Array.from({length:ROUNDS}, ()=>Array.from({length:TEAMS}, ()=>null)),
      drafted: new Set(),
      selected: { r:0, t: MY_TEAM_INDEX },
    };

    const boardEl = document.getElementById("board");
    const rankingsBodyEl = document.getElementById("rankingsBody");
    const searchInputEl = document.getElementById("searchInput");
    const posFilterEl = document.getElementById("posFilter");
    const hideDraftedEl = document.getElementById("hideDrafted");
    const rosterEl = document.getElementById("roster");
    const needsEl = document.getElementById("needsText");
    const myTeamTitleEl = document.getElementById("myTeamTitle");

    function renderBoard() {
      boardEl.innerHTML = "";
      const hdrRound = document.createElement("div");
      hdrRound.className = "hdr sticky-col";
      hdrRound.textContent = "R/T";
      boardEl.appendChild(hdrRound);

      for (let t=0; t<TEAMS; t++) {
        const h = document.createElement("div"); h.className = "hdr";
        const input = document.createElement("input"); input.value = state.teamNames[t]; input.className="team-input";
        input.addEventListener("change", (e)=>{ state.teamNames[t] = e.target.value; saveAuto(); updateMyTeamTitle(); });
        h.appendChild(input); boardEl.appendChild(h);
      }

      for (let r=0; r<ROUNDS; r++) {
        const roundCell = document.createElement("div");
        roundCell.className="cell sticky-col round-label"; roundCell.textContent = "R"+(r+1);
        boardEl.appendChild(roundCell);

        for (let t=0; t<TEAMS; t++) {
          const cell = document.createElement("div"); cell.className="cell"; cell.dataset.r=r; cell.dataset.t=t;
          const pick = state.picks[r][t];
          if (pick) {
            cell.appendChild(makePlayerPill(pick));
            cell.style.background = hexToRgba(posHex(pick.pos), 0.12);
            cell.style.boxShadow = "inset 0 0 0 2px " + posColor(pick.pos);
          } else {
            const hint = document.createElement("div"); hint.style.opacity=0.6; hint.textContent = "#"+pickNumber(r,t);
            cell.appendChild(hint); cell.style.background="#fff"; cell.style.boxShadow="none";
          }
          cell.addEventListener("click",()=>selectCell(r,t));
          boardEl.appendChild(cell);
        }
      }

      if (state.selected) {
        const sel = [...document.querySelectorAll(".cell")].find(c => Number(c.dataset?.r)===state.selected.r && Number(c.dataset?.t)===state.selected.t);
        if (sel) sel.classList.add("selected");
      }
    }

    function makePlayerPill(pick) {
      const w = document.createElement("div"); w.className="player-pill";
      const d = document.createElement("span"); d.className="pos-dot"; d.style.background = posColor(pick.pos);
      const tx = document.createElement("span"); tx.className="pill-text"; tx.textContent = pick.pos ? `${pick.player} (${pick.pos})` : pick.player;
      const act = document.createElement("div"); act.className="pill-actions";
      const x = document.createElement("button"); x.className="icon-btn"; x.title="Clear"; x.textContent="✕";
      x.addEventListener("click",(e)=>{ e.stopPropagation(); clearPickByKey(pickKey(pick.player)); });
      act.appendChild(x); w.appendChild(d); w.appendChild(tx); w.appendChild(act); return w;
    }

    function selectCell(r,t) {
      state.selected = { r, t };
      document.querySelectorAll(".cell").forEach(c=>c.classList.remove("selected"));
      const sel = [...document.querySelectorAll(".cell")].find(c => Number(c.dataset?.r)===r && Number(c.dataset?.t)===t);
      if (sel) sel.classList.add("selected");
    }

    function placePlayerAtSelected(row) {
      if (!state.selected) return alert("Select a cell first.");
      const { r, t } = state.selected;
      const existing = state.picks[r][t]; if (existing) state.drafted.delete(pickKey(existing.player));
      state.picks[r][t] = { player: row.player, pos: row.pos || "" };
      state.drafted.add(pickKey(row.player));
      renderBoard(); renderRankings(); renderRoster(); saveAuto();
      const next = nextPick(r,t); if (next) selectCell(next.r,next.t);
    }

    function nextPick(r,t) {
      if (isSnakeLTR(r)) { if (t<TEAMS-1) return { r, t:t+1 }; }
      else { if (t>0) return { r, t:t-1 }; }
      if (r<ROUNDS-1) { const lr = isSnakeLTR(r+1); return { r:r+1, t: lr?0:TEAMS-1 }; }
      return null;
    }

    function clearPickByKey(key) {
      for (let r=0;r<ROUNDS;r++) for (let t=0;t<TEAMS;t++) {
        const p = state.picks[r][t];
        if (p && pickKey(p.player)===key) { state.picks[r][t]=null; state.drafted.delete(key); }
      }
      renderBoard(); renderRankings(); renderRoster(); saveAuto();
    }

    // Rankings
    let filtered = [...RANKINGS_DATA];
    function applyFilters() {
      const q = (searchInputEl.value||"").trim().toUpperCase();
      const posF = (posFilterEl.value||"").trim().toUpperCase();
      const hide = hideDraftedEl.checked;
      filtered = RANKINGS_DATA.filter(r => {
        const matchesQ = !q || String(r.player).toUpperCase().includes(q);
        const matchesP = !posF || String(r.pos).toUpperCase() === posF;
        const hideIt = hide && state.drafted.has(pickKey(r.player));
        return matchesQ && matchesP && !hideIt;
      });
      filtered.sort((a,b) => (Number(a.overall)||99999) - (Number(b.overall)||99999));
    }
    function renderRankings() {
      applyFilters();
      rankingsBodyEl.innerHTML = "";
      for (const row of filtered) {
        const tr = document.createElement("tr"); tr.className="rank-row";
        const drafted = state.drafted.has(pickKey(row.player)); if (drafted) tr.classList.add("drafted");
        const tdO = document.createElement("td"); tdO.textContent = row.overall||"";
        const tdP = document.createElement("td"); tdP.textContent = row.player||"";
        const tdPos = document.createElement("td");
        const chip = document.createElement("span"); chip.className="pos-chip";
        const dot = document.createElement("span"); dot.className="dot"; dot.style.cssText = "width:10px;height:10px;border-radius:999px;background:"+posColor(row.pos);
        const tx = document.createElement("span"); tx.textContent = row.pos||""; chip.appendChild(dot); chip.appendChild(tx); tdPos.appendChild(chip);
        const tdPR = document.createElement("td"); tdPR.textContent = row.posRank||"";
        const tdT = document.createElement("td"); tdT.textContent = row.tier||"";
        tr.appendChild(tdO); tr.appendChild(tdP); tr.appendChild(tdPos); tr.appendChild(tdPR); tr.appendChild(tdT);
        tr.addEventListener("click", () => { if (!drafted) placePlayerAtSelected(row); });
        rankingsBodyEl.appendChild(tr);
      }
    }

    // Roster
    function rosterFromPicks() {
      const picks = [];
      for (let r=0; r<ROUNDS; r++) { const p = state.picks[r][MY_TEAM_INDEX]; if (p) picks.push(p); }
      const slots = {"QB":null,"RB1":null,"RB2":null,"WR1":null,"WR2":null,"TE":null,"FLEX":null,"DST":null,"K":null};
      const bench = [];
      const assignFirst = (player, keys) => { for (const k of keys) { if (slots[k]===null) { slots[k]=player; return true; } } return false; };
      for (const p of picks) {
        const POS = String(p.pos||"").toUpperCase();
        if (POS==="QB") { if (!assignFirst(p,["QB"])) bench.push(p); continue; }
        if (POS==="RB") { if (!assignFirst(p,["RB1","RB2"])) { if (!slots["FLEX"] && flexEligible(POS)) slots["FLEX"]=p; else bench.push(p); } continue; }
        if (POS==="WR") { if (!assignFirst(p,["WR1","WR2"])) { if (!slots["FLEX"] && flexEligible(POS)) slots["FLEX"]=p; else bench.push(p); } continue; }
        if (POS==="TE") { if (!assignFirst(p,["TE"])) { if (!slots["FLEX"] && flexEligible(POS)) slots["FLEX"]=p; else bench.push(p); } continue; }
        if (["DEF","D/ST","DST","DEF/ST"].includes(POS)) { if (!assignFirst(p,["DST"])) bench.push(p); continue; }
        if (["K","KICKER"].includes(POS)) { if (!assignFirst(p,["K"])) bench.push(p); continue; }
        bench.push(p);
      }
      return { slots, bench: bench.slice(0,6), benchOverflow: Math.max(0, bench.length-6) };
    }
    function playerPillSmall(p) { const div=document.createElement("div"); div.className="player-pill"; div.style.padding="4px 6px";
      const dot=document.createElement("span"); dot.className="pos-dot"; dot.style.background=posColor(p.pos); dot.style.width="10px"; dot.style.height="10px";
      const txt=document.createElement("span"); txt.className="pill-text"; txt.textContent = p.pos ? `${p.player} (${p.pos})` : p.player; div.appendChild(dot); div.appendChild(txt); return div; }
    function renderRoster() {
      updateMyTeamTitle();
      const { slots, bench, benchOverflow } = rosterFromPicks();
      const rosterEl = document.getElementById("roster"); rosterEl.innerHTML="";
      const order = ["QB","RB1","RB2","WR1","WR2","TE","FLEX","DST","K"];
      for (const key of order) { const row=document.createElement("div"); row.className="slot";
        const lab=document.createElement("div"); lab.className="slot-label"; lab.textContent=key;
        const val=document.createElement("div"); if (slots[key]) val.appendChild(playerPillSmall(slots[key])); else { const s=document.createElement("span"); s.className="empty"; s.textContent="—"; val.appendChild(s); }
        row.appendChild(lab); row.appendChild(val); rosterEl.appendChild(row);
      }
      const benchTitle=document.createElement("div"); benchTitle.style.marginTop="8px"; benchTitle.style.fontWeight="700"; benchTitle.textContent="Bench (6)"; rosterEl.appendChild(benchTitle);
      const grid=document.createElement("div"); grid.className="bench-grid";
      for (let i=0;i<6;i++) { const row=document.createElement("div"); row.className="slot";
        const lab=document.createElement("div"); lab.className="slot-label"; lab.textContent="BN"+(i+1);
        const val=document.createElement("div"); if (bench[i]) val.appendChild(playerPillSmall(bench[i])); else { const s=document.createElement("span"); s.className="empty"; s.textContent="—"; val.appendChild(s); }
        row.appendChild(lab); row.appendChild(val); grid.appendChild(row);
      } rosterEl.appendChild(grid);
      const needs=[]; if(!slots.QB)needs.push("QB"); if(!slots.RB1)needs.push("RB"); if(!slots.RB2)needs.push("RB"); if(!slots.WR1)needs.push("WR"); if(!slots.WR2)needs.push("WR"); if(!slots.TE)needs.push("TE"); if(!slots.FLEX)needs.push("FLEX"); if(!slots.DST)needs.push("DEF/ST"); if(!slots.K)needs.push("K");
      document.getElementById("needsText").textContent = (needs.length?("Needs: "+needs.join(", ")):"Starters filled. Build bench depth.");
      if (benchOverflow) document.getElementById("needsText").textContent += ` (+${benchOverflow} extra on bench)`;
    }
    function updateMyTeamTitle() { if (!state.teamNames[MY_TEAM_INDEX] || state.teamNames[MY_TEAM_INDEX].startsWith("Team ")) state.teamNames[MY_TEAM_INDEX] = MY_TEAM_NAME; document.getElementById("myTeamTitle").textContent = state.teamNames[MY_TEAM_INDEX] + " — Pick 5 (Roster)"; }

    // Persistence
    const LS_KEY = "snakeDraftState_v6";
    function saveAuto() { try { localStorage.setItem(LS_KEY, JSON.stringify({teamNames: state.teamNames, picks: state.picks, drafted: Array.from(state.drafted), selected: state.selected})); } catch(e){} }
    function loadFromStorage() { try { const raw=localStorage.getItem(LS_KEY); if(!raw) return false; const obj=JSON.parse(raw); if(!obj||!Array.isArray(obj.picks)) return false; state.teamNames=obj.teamNames||state.teamNames; state.picks=obj.picks||state.picks; state.drafted=new Set(obj.drafted||[]); state.selected=obj.selected||state.selected; if(!state.teamNames[MY_TEAM_INDEX]||state.teamNames[MY_TEAM_INDEX].startsWith("Team ")) state.teamNames[MY_TEAM_INDEX]=MY_TEAM_NAME; return true; } catch(e){ return false; } }
    function clearStorage() { localStorage.removeItem(LS_KEY); }

    document.getElementById("saveStateBtn").addEventListener("click", saveAuto);
    document.getElementById("loadStateBtn").addEventListener("click", ()=>{ loadFromStorage(); renderBoard(); renderRankings(); renderRoster(); });
    document.getElementById("clearStateBtn").addEventListener("click", ()=>{ if(confirm("Clear all saved state and reset the board?")){ clearStorage(); state.teamNames=Array.from({length:TEAMS},(_,i)=>"Team "+(i+1)); state.teamNames[MY_TEAM_INDEX]=MY_TEAM_NAME; state.picks=Array.from({length:ROUNDS},()=>Array.from({length:TEAMS},()=>null)); state.drafted=new Set(); state.selected={r:0,t:MY_TEAM_INDEX}; renderBoard(); renderRankings(); renderRoster(); } });
    document.getElementById("downloadJsonBtn").addEventListener("click", ()=>{ const data={teamNames:state.teamNames,picks:state.picks}; const blob=new Blob([JSON.stringify(data,null,2)],{type:"application/json"}); const url=URL.createObjectURL(blob); const a=document.createElement("a"); a.href=url; a.download="snake_draft_export.json"; a.click(); URL.revokeObjectURL(url); });

    // Filters
    document.getElementById("searchInput").addEventListener("input", renderRankings);
    document.getElementById("posFilter").addEventListener("change", renderRankings);
    document.getElementById("hideDrafted").addEventListener("change", renderRankings);

    // Init
    loadFromStorage();
    if (!state.teamNames[MY_TEAM_INDEX] || state.teamNames[MY_TEAM_INDEX].startsWith("Team ")) state.teamNames[MY_TEAM_INDEX]=MY_TEAM_NAME;
    renderBoard(); renderRankings(); renderRoster();
    if (state.selected) { const {r,t} = state.selected; const sel=[...document.querySelectorAll(".cell")].find(c=>Number(c.dataset?.r)===r && Number(c.dataset?.t)===t); if (sel) sel.classList.add("selected"); }
  } catch (e) {
    showError("Init error: " + (e?.message || String(e)));
  }
})();
</script>
</body>
</html>
